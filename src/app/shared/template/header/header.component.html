<div class="header">
  <div class="logo logo-dark">
    <a routerLink="dashboard/home">
      <img
        alt="Logo"
        src="assets/images/finalized-images/Logo.png"
        style="width: 160px; height: 75px; padding: 5px"
      />
      <img
        alt="Logo"
        class="logo-fold"
        src="assets/images/finalized-images/Logo.png"
      />
    </a>
  </div>
  <div class="logo logo-white">
    <div routerLink="dashboard/home">
      <img alt="Logo" src="assets/images/finalized-images/Logo.png"/>
      <img
        alt="Logo"
        class="logo-fold"
        src="assets/images/finalized-images/Logo.png"
        style="width: 160px; height: 75px; padding: 5px"
      />
    </div>
  </div>
  <div class="logo logo-white">
    <div routerLink="dashboard/home">
      <img
        alt="Logo"
        src="assets/images/finalized-images/Logo.png"
        style="width: 160px; height: 75px; padding: 5px"
      />
      <img
        alt="Logo"
        class="logo-fold"
        src="assets/images/finalized-images/Logo.png"
        style="width: 160px; height: 75px; padding: 5px"
      />
    </div>
  </div>
  <div class="nav-wrap">
    <ul class="nav-left">
      <li class="desktop-toggle">
        <a (click)="toggleFold()">
          <i
            [nzType]="isFolded ? 'menu-unfold' : 'menu-fold'"
            nz-icon
            theme="outline"
          ></i>
        </a>
      </li>
      <li class="mobile-toggle">
        <a (click)="toggleExpand()">
          <i
            [nzType]="isExpand ? 'menu-fold' : 'menu-unfold'"
            nz-icon
            theme="outline"
          ></i>
        </a>
      </li>
    </ul>
    <div
      *ngIf="
        (authService.currentUser$ | async).banner &&
        !(authService.currentUser$ | async).reel_eval_admin
      "
      class="banner"
    >
      <div>
        {{ (authService.currentUser$ | async).banner }}
      </div>
    </div>
    <ul class="nav-right">
      <li>
        <span
          [nzDropdownMenu]="profile"
          [nzPlacement]="'bottomRight'"
          [nzTrigger]="'click'"
          class="p-h-10 pointer"
          nz-dropdown
        >
          <nz-avatar
            [ngStyle]="{ 'background-color': '#3f87f5' }"
            [nzText]="(authService.currentUser$ | async).first_name"
            nzGap="4"
            nzSize="large"
            style="vertical-align: middle"
          ></nz-avatar>
        </span>
        <nz-dropdown-menu #profile="nzDropdownMenu">
          <ul class="p-b-15 p-t-20" nz-menu>
            <li class="p-h-20 p-b-15 m-b-10 border-bottom">
              <div class="d-flex m-r-50">
                <div class="m-l-10">
                  <p class="m-b-0 text-dark font-weight-semibold">
                    {{ (authService.currentUser$ | async).username }}
                  </p>
                  <p class="m-b-0 opacity-07">
                    {{ (authService.currentUser$ | async).group }}
                  </p>
                </div>
              </div>
            </li>

            <li
              (click)="showModalPassword()"
              *ngIf="!(authService.currentUser$ | async).reel_eval_admin"
              nz-menu-item
            >
              <a class="p-v-5 d-flex align-items-center">
                Change Your Password
              </a>
              <nz-modal
                [(nzVisible)]="isVisiblePass"
                nzCentered="true"
                nzCloseIcon="null"
                nzTitle="Change Your Password"
              >
                <ng-container *nzModalContent>
                  <form [formGroup]="changePasswordForm">
                    <span>
                      <nz-form-item nz-row>
                        <nz-form-label nz-col nzRequired nzSpan="24"
                        >Old Password</nz-form-label
                        >
                        <nz-form-control
                          [nzErrorTip]="old_password.errors?.['msg'] ?  old_password.errors?.['msg'] : 'Please input your old password!'"
                        >
                          <nz-input-group
                            [nzSuffix]="suffixTemplate1"
                            nz-col
                            nzSpan="24"
                          >
                            <input
                              [type]="oldPassVisible ? 'text' : 'password'"
                              formControlName="old_password"
                              nz-input
                              placeholder="Enter your old password"
                            />
                          </nz-input-group>
                        </nz-form-control>
                        <ng-template #suffixTemplate1>
                          <i
                            (click)="oldPassVisible = !oldPassVisible"
                            [nzType]="oldPassVisible ? 'eye-invisible' : 'eye'"
                            nz-icon
                          ></i>
                        </ng-template>
                      </nz-form-item>
                    </span>
                    <span>
                      <nz-form-item nz-row>
                        <nz-form-label
                          nz-col
                          nzFor="new_password2"
                          nzRequired
                          nzSpan="24"
                        >New Password</nz-form-label
                        >
                        <nz-form-control
                          [nzErrorTip]="new_password2.errors?.['msg'] ?  new_password2.errors?.['msg'] : 'Please input your new Password!'"
                        >
                          <nz-input-group
                            [nzSuffix]="suffixTemplate3"
                            nz-col
                            nzSpan="24"
                          >
                            <input
                              [type]="newPassVisible1 ? 'text' : 'password'"
                              formControlName="new_password2"
                              id="new_password2"
                              nz-input
                              placeholder="Enter your new password"
                            />
                          </nz-input-group>
                        </nz-form-control>
                        <ng-template #suffixTemplate3>
                          <i
                            (click)="newPassVisible1 = !newPassVisible1"
                            [nzType]="newPassVisible1 ? 'eye-invisible' : 'eye'"
                            nz-icon
                          ></i>
                        </ng-template>
                      </nz-form-item>
                    </span>
                    <span>
                      <nz-form-item nz-row>
                        <nz-form-label
                          nz-col
                          nzFor="newPass2"
                          nzRequired
                          nzSpan="24"
                        >Confirm Password</nz-form-label
                        >
                        <nz-form-control
                          nzErrorTip="Please confirm your password!"
                        >
                          <nz-input-group
                            [nzSuffix]="suffixTemplate2"
                            nz-col
                            nzSpan="24"
                          >
                            <input
                              [type]="newPassVisible2 ? 'text' : 'password'"
                              formControlName="new_password1"
                              id="newPass2"
                              nz-input
                              placeholder="Confirm Password"
                            />
                          </nz-input-group>
                        </nz-form-control>
                        <ng-template #suffixTemplate2>
                          <i
                            (click)="newPassVisible2 = !newPassVisible2"
                            [nzType]="newPassVisible2 ? 'eye-invisible' : 'eye'"
                            nz-icon
                          ></i>
                        </ng-template>
                      </nz-form-item>
                    </span>
                  </form>
                </ng-container>
                <ng-container *nzModalFooter>
                  <button (click)="cancelPassword()" nz-button nzType="default">
                    Cancel
                  </button>
                  <button
                    (click)="okPassword()"
                    [disabled]="changePasswordForm.invalid"
                    nz-button
                    nzType="primary"
                  >
                    OK
                  </button>
                </ng-container>
              </nz-modal>
            </li>
            <li
              (click)="showModal()"
              *ngIf="!(authService.currentUser$ | async).reel_eval_admin"
              nz-menu-item
            >
              <a class="p-v-5 d-flex align-items-center">
                Create Support Ticket
              </a>
              <nz-modal
                [(nzVisible)]="isVisible"
                nzTitle="Report Bug"
                nzCentered="true"
                nzCloseIcon="null"
              >
                <ng-container *nzModalContent>
                  <div [formGroup]="bugForm">
                    <div class="m-2">
                      <h6>Subject:</h6>
                      <input
                        formControlName="subject"
                        nz-input
                        placeholder="Enter the subject"
                        type="text"
                      />
                    </div>
                    <div class="m-2">
                      <h6>Message:</h6>
                      <textarea
                        formControlName="message"
                        nz-input
                        placeholder="Enter the message"
                        rows="4"
                      ></textarea>
                    </div>
                    <div class="m-2">
                      <h6>Attachment:</h6>
                      <nz-upload
                        [(nzFileList)]="fileList"
                        [nzAccept]="['.png', '.jpeg']"
                        [nzBeforeUpload]="beforeUpload"
                        nzMultiple="true"
                      >
                        <button class="d-flex" nz-button nzType="primary">
                          <span nz-icon nzType="upload"></span>
                          Select file
                        </button>
                      </nz-upload>
                    </div>
                  </div>
                </ng-container>
                <ng-container *nzModalFooter>
                  <button (click)="handleCancel()" nz-button nzType="default">
                    Cancel
                  </button>
                  <button
                    (click)="handleOk()"
                    [disabled]="bugForm.invalid"
                    nz-button
                    nzType="primary"
                  >
                    OK
                  </button>
                </ng-container>
              </nz-modal>
            </li>
            <li (click)="logout()" nz-menu-item>
              <a
                class="p-v-5 d-flex align-items-center justify-content-between"
              >
                <div>
                  <i
                    class="opacity-04 font-size-16"
                    nz-icon
                    nzType="logout"
                    theme="outline"
                  ></i>
                  <span class="m-l-10">Logout</span>
                </div>
              </a>
            </li>
          </ul>
        </nz-dropdown-menu>
      </li>
    </ul>
  </div>
</div>
