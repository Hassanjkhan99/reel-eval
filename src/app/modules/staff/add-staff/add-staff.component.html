<div class="row">
  <div class="col-12">
    <h2>Add Staff Member</h2>
    <hr/>
  </div>
</div>

<div [nzGutter]="24" class="w-50" nz-row>
  <div [nzLg]="24" [nzMd]="24" [nzSm]="24" [nzXl]="24" [nzXs]="24" nz-col>
    <div *ngIf="staffCount >= 20">
      <nz-alert
        class="text-center my-4"
        nzDescription="You have reached maximum account limit which is 20!"
        nzMessage="Cannot create another account"
        nzType="error"
      ></nz-alert>
    </div>
    <app-card>
      <form [formGroup]="coachForm" nz-form>
        <div nz-row>
          <div
            [nzLg]="24"
            [nzMd]="24"
            [nzSm]="24"
            [nzXl]="24"
            [nzXs]="24"
            nz-col
          >
            <nz-form-item nz-row>
              <div
                [nzLg]="7"
                [nzMd]="7"
                [nzSm]="24"
                [nzXl]="7"
                [nzXs]="24"
                class="t-right"
                nz-col
              >
                <nz-form-label>First name</nz-form-label>
              </div>
              <div
                [nzLg]="14"
                [nzMd]="14"
                [nzSm]="24"
                [nzXl]="14"
                [nzXs]="24"
                nz-col
              >
                <nz-form-control [nzErrorTip]="userErrorTpl" nzHasFeedback>
                  <input
                    formControlName="first_name"
                    nz-input
                    placeholder="First Name"
                  />
                  <ng-template #userErrorTpl let-control>
                    <ng-container *ngIf="control.hasError('required')">
                      Please enter your First Name!
                    </ng-container>
                  </ng-template>
                </nz-form-control>
              </div>
            </nz-form-item>
            <nz-form-item>
              <div
                [nzLg]="7"
                [nzMd]="7"
                [nzSm]="24"
                [nzXl]="7"
                [nzXs]="24"
                class="t-right"
                nz-col
              >
                <nz-form-label>Last Name</nz-form-label>
              </div>
              <div
                [nzLg]="14"
                [nzMd]="14"
                [nzSm]="24"
                [nzXl]="14"
                [nzXs]="24"
                nz-col
              >
                <nz-form-control [nzErrorTip]="userErrorTpl" nzHasFeedback>
                  <input
                    formControlName="last_name"
                    nz-input
                    placeholder="Last Name"
                  />
                  <ng-template #userErrorTpl let-control>
                    <ng-container *ngIf="control.hasError('required')">
                      Please enter your Last Name!
                    </ng-container>
                  </ng-template>
                </nz-form-control>
              </div>
            </nz-form-item>
            <nz-form-item>
              <div
                [nzLg]="7"
                [nzMd]="7"
                [nzSm]="24"
                [nzXl]="7"
                [nzXs]="24"
                class="t-right"
                nz-col
              >
                <nz-form-label>E-mail</nz-form-label>
              </div>
              <div
                [nzLg]="14"
                [nzMd]="14"
                [nzSm]="24"
                [nzXl]="14"
                [nzXs]="24"
                nz-col
              >
                <nz-form-control [nzErrorTip]="emailErrorTpl" nzHasFeedback>
                  <input
                    formControlName="email"
                    nz-input
                    placeholder="email"
                    type="email"
                  />
                  <ng-template #emailErrorTpl let-control>
                    <ng-container *ngIf="control.hasError('email')">
                      The input is not valid E-mail!
                    </ng-container>
                    <ng-container *ngIf="control.hasError('required')">
                      Please input your E-mail!
                    </ng-container>
                  </ng-template>
                </nz-form-control>
              </div>
            </nz-form-item>
          </div>
          <div
            [nzLg]="24"
            [nzMd]="24"
            [nzSm]="24"
            [nzXl]="24"
            [nzXs]="24"
            nz-col
          >
            <nz-form-item>
              <div
                [nzLg]="7"
                [nzMd]="7"
                [nzSm]="24"
                [nzXl]="7"
                [nzXs]="24"
                class="t-right"
                nz-col
              >
                <nz-form-label>Username</nz-form-label>
              </div>
              <div
                [nzLg]="14"
                [nzMd]="14"
                [nzSm]="24"
                [nzXl]="14"
                [nzXs]="24"
                nz-col
              >
                <nz-form-control [nzErrorTip]="userErrorTpl" nzHasFeedback>
                  <input
                    formControlName="username"
                    nz-input
                    placeholder="Username"
                  />
                  <ng-template #userErrorTpl let-control>
                    <ng-container *ngIf="control.hasError('required')">
                      Please input your username!
                    </ng-container>
                  </ng-template>
                </nz-form-control>
              </div>
            </nz-form-item>

            <nz-form-item>
              <div
                [nzLg]="7"
                [nzMd]="7"
                [nzSm]="24"
                [nzXl]="7"
                [nzXs]="24"
                class="t-right"
                nz-col
              >
                <nz-form-label>Password</nz-form-label>
              </div>
              <div
                [nzLg]="14"
                [nzMd]="14"
                [nzSm]="24"
                [nzXl]="14"
                [nzXs]="24"
                nz-col
              >
                <nz-form-control
                  nzErrorTip="Please input your password!"
                  nzHasFeedback
                >
                  <nz-input-group [nzSuffix]="suffixTemplate">
                    <input
                      (ngModelChange)="validateConfirmPassword()"
                      [type]="passwordVisible ? 'text' : 'password'"
                      formControlName="password1"
                      id="password1"
                      nz-input
                      placeholder="Password"
                    />
                  </nz-input-group>
                  <ng-template #suffixTemplate>
                    <i
                      (click)="passwordVisible = !passwordVisible"
                      [nzType]="passwordVisible ? 'eye-invisible' : 'eye'"
                      nz-icon
                    ></i>
                  </ng-template>
                </nz-form-control>
              </div>
            </nz-form-item>

            <nz-form-item>
              <div
                [nzLg]="7"
                [nzMd]="7"
                [nzSm]="24"
                [nzXl]="7"
                [nzXs]="24"
                class="t-right"
                nz-col
              >
                <nz-form-label>Confirm Password</nz-form-label>
              </div>
              <div
                [nzLg]="14"
                [nzMd]="14"
                [nzSm]="24"
                [nzXl]="14"
                [nzXs]="24"
                nz-col
              >
                <nz-form-control [nzErrorTip]="passwordErrorTpl" nzHasFeedback>
                  <nz-input-group [nzSuffix]="suffixTemplate2">
                    <input
                      [type]="passwordVisible2 ? 'text' : 'password'"
                      formControlName="password2"
                      id="password2"
                      nz-input
                      placeholder="Confirm Password"
                    />
                  </nz-input-group>
                  <ng-template #passwordErrorTpl let-control>
                    <ng-container *ngIf="control.hasError('required')">
                      Please confirm your password!
                    </ng-container>
                    <ng-container *ngIf="control.hasError('confirm')">
                      Password is inconsistent!
                    </ng-container>
                  </ng-template>
                  <ng-template #suffixTemplate2>
                    <i
                      (click)="passwordVisible2 = !passwordVisible2"
                      [nzType]="passwordVisible2 ? 'eye-invisible' : 'eye'"
                      nz-icon
                    ></i>
                  </ng-template>
                </nz-form-control>
              </div>
            </nz-form-item>
            <nz-form-item>
              <div
                [nzLg]="7"
                [nzMd]="7"
                [nzSm]="24"
                [nzXl]="7"
                [nzXs]="24"
                class="t-right"
                nz-col
                *ngIf="!(authService.currentUser$ | async).reel_eval_admin"

              >
                <nz-form-label>Permissions</nz-form-label>
              </div>
              <div
                [nzLg]="14"
                [nzMd]="14"
                [nzSm]="24"
                [nzXl]="14"
                [nzXs]="24"
                nz-col
                *ngIf="!(authService.currentUser$ | async).reel_eval_admin"
              >
                <nz-form-control>
                  <nz-select
                    formControlName="groups"
                    nzPlaceHolder="Select Permissions"
                  >
                    <nz-option
                      *ngFor="let permissions of options"
                      [nzLabel]="permissions.name"
                      [nzValue]="permissions.id"
                    >
                    </nz-option>
                  </nz-select>
                </nz-form-control>
              </div>
            </nz-form-item>
          </div>
        </div>
      </form>
    </app-card>
  </div>

  <div class="d-flex justify-content-center w-100">
    <button
      (click)="submitForm()"
      [disabled]="!coachForm.valid"
      [nzLoading]="loadingService.loading | async"
      nz-button
      nzType="primary"
    >
      Submit
    </button>
  </div>
</div>
